<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="waterpumpkwale">
<title>Example: track pump location and volume change • waterpumpkwale</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example: track pump location and volume change">
<meta property="og:description" content="waterpumpkwale">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="openwashdata.github.io/waterpumpkwale" src="https://plausible.io/js/script.js"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">waterpumpkwale</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/examples.html">Example: track pump location and volume change</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="examples_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="examples_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="examples_files/leaflet-1.3.1/leaflet.js"></script><link href="examples_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="examples_files/proj4-2.6.2/proj4.min.js"></script><script src="examples_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="examples_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="examples_files/leaflet-binding-2.2.0/leaflet.js"></script><script src="examples_files/leaflet-providers-1.13.0/leaflet-providers_1.13.0.js"></script><script src="examples_files/leaflet-providers-plugin-2.2.0/leaflet-providers-plugin.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Example: track pump location and volume change</h1>
                        <h4 data-toc-skip class="author">Mian Zhong</h4>
            
      
      
      <div class="d-none name"><code>examples.Rmd</code></div>
    </div>

    
    
<p>In this example, you will see how to use this data package to:</p>
<ol style="list-style-type: decimal">
<li>Plot an interactive map to show all monitored water hand pumps.</li>
<li>Visualize the weekly volume change.</li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">waterpumpkwale</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="hand-pump-location-map">Hand Pump Location Map<a class="anchor" aria-label="anchor" href="#hand-pump-location-map"></a>
</h2>
<p>Using the <code>location</code> dataset, we can plot an interactive
map to show the locations of the hand pumps. Notice that each pump ID
starts with a letter from “A”, “B”, “C”, “D”, “E”, which may refer to a
group the pumps belong to. With this assumption, we enable the
<code>group</code> option in leaflet so we can select which group to be
displayed.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># customize marker icon </span></span>
<span><span class="va">handpumpicon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/makeIcon.html" class="external-link">makeIcon</a></span><span class="op">(</span></span>
<span>  iconUrl <span class="op">=</span> <span class="st">"https://cdn-icons-png.flaticon.com/512/5984/5984318.png"</span>,</span>
<span>  iconWidth <span class="op">=</span> <span class="fl">30</span>, iconHeight <span class="op">=</span> <span class="fl">30</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot an interactive map with group option</span></span>
<span><span class="va">handpumpmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span>options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html" class="external-link">leafletOptions</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/leaflet.html" class="external-link">leafletCRS</a></span><span class="op">(</span>proj4def <span class="op">=</span> <span class="st">"WGS84"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># declare coordinate system</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addProviderTiles.html" class="external-link">addProviderTiles</a></span><span class="op">(</span><span class="st">"OpenStreetMap"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addMarkers</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu">waterpumpkwale</span><span class="fu">::</span><span class="va"><a href="../reference/location.html">location</a></span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="va">pumpid</span>, <span class="st">"A"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># select pump id that starts with a particular string pattern</span></span>
<span>    lng <span class="op">=</span> <span class="op">~</span><span class="va">`long_wgs84`</span>,</span>
<span>    lat <span class="op">=</span> <span class="op">~</span><span class="va">`lat_wgs84`</span>,</span>
<span>    popup <span class="op">=</span> <span class="op">~</span><span class="va">pumpid</span>,</span>
<span>    label <span class="op">=</span> <span class="op">~</span><span class="va">description</span>,</span>
<span>    icon <span class="op">=</span> <span class="va">handpumpicon</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Pump ID: A"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addMarkers</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu">waterpumpkwale</span><span class="fu">::</span><span class="va"><a href="../reference/location.html">location</a></span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="va">pumpid</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    lng <span class="op">=</span> <span class="op">~</span><span class="va">`long_wgs84`</span>,</span>
<span>    lat <span class="op">=</span> <span class="op">~</span><span class="va">`lat_wgs84`</span>,</span>
<span>    popup <span class="op">=</span> <span class="op">~</span><span class="va">pumpid</span>,</span>
<span>    label <span class="op">=</span> <span class="op">~</span><span class="va">description</span>,</span>
<span>    icon <span class="op">=</span> <span class="va">handpumpicon</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Pump ID: B"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addMarkers</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu">waterpumpkwale</span><span class="fu">::</span><span class="va"><a href="../reference/location.html">location</a></span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="va">pumpid</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    lng <span class="op">=</span> <span class="op">~</span><span class="va">`long_wgs84`</span>,</span>
<span>    lat <span class="op">=</span> <span class="op">~</span><span class="va">`lat_wgs84`</span>,</span>
<span>    popup <span class="op">=</span> <span class="op">~</span><span class="va">pumpid</span>,</span>
<span>    label <span class="op">=</span> <span class="op">~</span><span class="va">description</span>,</span>
<span>    icon <span class="op">=</span> <span class="va">handpumpicon</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Pump ID: C"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addMarkers</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu">waterpumpkwale</span><span class="fu">::</span><span class="va"><a href="../reference/location.html">location</a></span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="va">pumpid</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    lng <span class="op">=</span> <span class="op">~</span><span class="va">`long_wgs84`</span>,</span>
<span>    lat <span class="op">=</span> <span class="op">~</span><span class="va">`lat_wgs84`</span>,</span>
<span>    popup <span class="op">=</span> <span class="op">~</span><span class="va">pumpid</span>,</span>
<span>    label <span class="op">=</span> <span class="op">~</span><span class="va">description</span>,</span>
<span>    icon <span class="op">=</span> <span class="va">handpumpicon</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Pump ID: D"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/map-layers.html" class="external-link">addMarkers</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu">waterpumpkwale</span><span class="fu">::</span><span class="va"><a href="../reference/location.html">location</a></span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="va">pumpid</span>, <span class="st">"E"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    lng <span class="op">=</span> <span class="op">~</span><span class="va">`long_wgs84`</span>,</span>
<span>    lat <span class="op">=</span> <span class="op">~</span><span class="va">`lat_wgs84`</span>,</span>
<span>    popup <span class="op">=</span> <span class="op">~</span><span class="va">pumpid</span>,</span>
<span>    label <span class="op">=</span> <span class="op">~</span><span class="va">description</span>,</span>
<span>    icon <span class="op">=</span> <span class="va">handpumpicon</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"Pump ID: E"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="co"># Layers control</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addLayersControl.html" class="external-link">addLayersControl</a></span><span class="op">(</span></span>
<span>    overlayGroups  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pump ID: A"</span>, <span class="st">"Pump ID: B"</span>, <span class="st">"Pump ID: C"</span>, <span class="st">"Pump ID: D"</span>, <span class="st">"Pump ID: E"</span><span class="op">)</span>,</span>
<span>    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/leaflet/man/addLayersControl.html" class="external-link">layersControlOptions</a></span><span class="op">(</span>collapsed <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">handpumpmap</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-7d53ba3acf7f022938cf" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-7d53ba3acf7f022938cf">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":"WGS84","projectedBounds":null,"options":{}}},"calls":[{"method":"addProviderTiles","args":["OpenStreetMap",null,null,{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addMarkers","args":[[-4.4873991234,-4.424749996,-4.42670999594,-4.26869646604,-4.53329149837,-4.42489712239,-4.42493999601,-4.35379768186,-4.3402928615,-4.27179649659,-4.56369146471,-4.17339712676,-4.48789171464,-4.36329723833,-4.33459118355,-4.51449247121,-4.17739499383,-4.48659631114,-4.39889888962,-4.35759529576,-4.26589479498,-4.5714951386,-4.51839030846,-4.14499548274,-4.29319045799,-4.48879346536,-4.50199211991,-4.39955999597,-4.35360999608,-4.30349305831,-4.26599391986,-4.15209251677,-4.49299070204,-4.50369825026,-4.35605999602,-4.29989929566,-4.26219278599,-4.6142978406,-4.13389402982,-4.49139244284,-4.40017999602,-4.35539832691,-4.30079170139,-4.2612976549,-4.13059656662,-4.49789469747,-4.35489099885,-4.29849518657,-4.27129606512,-4.659391543,-4.12689268932,-4.4953920418,-4.39933957717,-4.35579898783,-4.30129598581,-4.27509275349,-4.51389385489,-4.34669790905,-4.27999199084,-4.50729087602,-4.38139910958,-4.3467909807,-4.55549751521,-4.50899487823,-4.33979123913,-4.37299730281,-4.34239501636,-4.50913949814,-4.37309603099,-4.34869459295,-4.51029079759,-4.51199278665,-4.51309298515,-4.51500999585],[39.4492190263,39.5067699985,39.5072299985,39.5765161526,39.2908163738,39.5052156088,39.5051999985,39.5366113881,39.5472179858,39.580312157,39.2824175552,39.5954119385,39.4572146623,39.5354104741,39.550611382,39.267713966,39.5962168422,39.4600171748,39.5167163431,39.5392186088,39.5849123837,39.2681136137,39.2711138469,39.6140135669,39.5691180844,39.4618123171,39.4475152798,39.5165699985,39.5381899985,39.5585101284,39.5854170784,39.6079104568,39.462310723,39.4534115459,39.5567199985,39.561715607,39.5876128922,39.204217418,39.6161132422,39.4576134537,39.5170699985,39.5499145046,39.566014749,39.5870174865,39.6220118943,39.4610157931,39.550914487,39.5643188977,39.5721116414,39.2170154316,39.6270182432,39.4559123013,39.5207205989,39.5463189351,39.5691150795,39.5758180531,39.4530122227,39.5469161884,39.5689100806,39.4515117853,39.5353151655,39.543311424,39.2519168672,39.4607162963,39.5403144346,39.5321188075,39.5425152211,39.4568406492,39.5332183912,39.5379145339,39.4571114424,39.4551113538,39.4606107071,39.4594199984],{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/5984/5984318.png","index":0},"iconWidth":30,"iconHeight":30},null,"Pump ID: A",{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["A/01/09","A/01/11","A/01/12","A/01/14","A/01/15","A/02/09","A/02/11","A/02/12","A/02/13","A/02/14","A/02/15","A/02/26","A/03/09","A/03/12","A/03/13","A/03/16","A/03/26","A/04/09","A/04/11","A/04/12","A/04/14","A/04/15","A/04/16","A/04/26","A/04/27","A/05/09","A/05/10","A/05/11","A/05/12","A/05/13","A/05/14","A/05/26","A/06/09","A/06/10","A/06/12","A/06/13","A/06/14","A/06/16","A/06/26","A/07/09","A/07/11","A/07/12","A/07/13","A/07/14","A/07/26","A/08/09","A/08/12","A/08/13","A/08/14","A/08/16","A/08/26","A/09/09","A/09/11","A/09/12","A/09/13","A/09/14","A/10/10","A/10/12","A/10/14","A/11/10","A/11/11","A/11/12","A/11/15","A/12/10","A/12/12","A/13/11","A/13/12","A/14/10","A/14/11","A/14/12","A/15/10","A/16/10","A/17/10","A/18/10"],null,null,null,["Mwisho wa Shamba","Gazi Mezea","Gazi Primary School","Mwaroni Primary","Mwachitsozi","Vinazini","Gazi La Mnyonge [Gazi Kangundo]","Galu Mwembeni","Mwabungo Tangulia","Mvumoni (Gombato Dispensary)","Mabokoni","Waa - Mwagonga Mwashipi","Gaphunzeni","Kinondo-Kaja la Simba","Tangulia","Mwangwei/Ganda 3","Waa / Mwashipi","Chinango ya Hamis Kassim","Makongeni School","Galu Chungoni","Mwakamba","Majoreni/Aleni","Mwangwei/Mtumba","Denyenye Maiga","Mkwakwani Shukrani","Chinango kwa Msunzu","Chikunguni","Makongeni Kambini","Galu Multipurpose Group (GMG)","Kona Ya Musa (Muuyu Gutu)","Herman Primary School","Denyenye / Masikizano","Chidze kwa Mzee Suleiman Shee","Ndzovuni","Mvureni-Maweni","Kona Ya Chief/Mwagutu","Mwakamba Msikitini","Kiwegu / Redeemed Nursery","Denyenye / Mzibani","Kingwede Sokoni","Makongeni Msikitini","Madago Primary School","Bambini/Silazima Borehole","Mwakamba","Ng'ombeni / Moshini 2","Mlimani","Madago Nursery School","Magutu/ Nashukuru Borehole","Mwaroni Nimutoto","Vanga Kiungani","Ng'ombeni / Moshini","Nyumba Sita","Makongeni Bandani","Silewe HP","Magutu/ Pekee Yake","Mwamambi B (Iddul - Ul Hajj Borehole)","Mkaliatsi/Munje Kokoni","Biga Madrassa","Mwamambi B Msikitini","Ndzovuni Msikitini","Kinondo Mganyi","Mangoloko","Mangawani Msikitini","Chirimatanda","Mwabungo-Mwangololko","Kinondo Pri. Sch.","Mwangoloko 2","Munje Madukani","Kinondo Mtengureni","Mwabungo Corner","Munje Primary","Jumapili","Golasingo","Munje Bujoni"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[-4.49729276125,-4.49912892012,-4.5209775349,-4.52337021855,-4.25100625185,-4.25327225359,-4.24254098951,-4.24109508013,-4.2397416891,-4.23860400301,-4.23419813286,-4.21707892114,-4.5209775349,-4.21467531366,-4.2007975755,-4.1958668901,-4.17829342861,-4.17375140878,-4.51980850345,-4.16668873782,-4.17013179842,-4.1502942963,-4.14960456748,-4.14658198703,-4.14282625834,-4.52811834974,-4.13275112489,-4.13704309788,-4.17381830393,-4.52799847393,-4.52911042967,-4.53114505517,-4.53136060705,-4.52974893819,-4.54603436602,-4.54361234421,-4.48343843923,-4.42960350491,-4.42457604782,-4.46620158435,-4.43625380643,-4.4410620913,-4.45261508107,-4.44684703462,-4.44015865038,-4.41227403499,-4.42359358413,-4.42611156031,-4.42673502862,-4.42788703039,-4.42111154271,-4.43634862687,-4.43518206228,-4.41754264655,-4.41299023441,-4.47577108406,-4.48763032471,-4.49481226841,-4.49909999565,-4.50726177218,-4.5035749455,-4.48539823674,-4.47241276177,-4.47984338319,-4.41178689896,-4.25491978435,-4.25271183029,-4.25624414484,-4.26040857964],[39.4243733639,39.4248521723,39.4067460005,39.3988236748,39.5826484237,39.5887324942,39.5798487291,39.5898045612,39.5851269522,39.5822786999,39.5826808885,39.5873715988,39.4067460005,39.5837656067,39.5965679323,39.597140846,39.6043085281,39.6053051622,39.4103510898,39.6020471895,39.5948869043,39.616990852,39.6198103452,39.6212315134,39.6231566363,39.4171526596,39.6315005436,39.6264225727,39.6123600167,39.4210738728,39.422381611,39.423807078,39.4264664739,39.4132863868,39.4102486841,39.4059383141,39.346466989,39.3022584401,39.2961453881,39.291204403,39.2997373789,39.2883913238,39.2872871356,39.2776133328,39.2852452642,39.2925713029,39.2869514439,39.2790837796,39.2810669468,39.2728472046,39.2716008942,39.2646750971,39.2634037857,39.2589269873,39.2644234518,39.2724772321,39.2748973948,39.2529145049,39.2266124129,39.221152237,39.2365115047,39.2135107125,39.1934960002,39.1806529427,39.1279720814,39.5753164508,39.5761798625,39.5825622474,39.5784293245],{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/5984/5984318.png","index":0},"iconWidth":30,"iconHeight":30},null,"Pump ID: B",{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["B/02/09","B/03/09","B/08/09","B/10/09","B/100/22","B/101/22","B/103/22","B/104/22","B/105/22","B/106/22","B/107/22","B/109/23","B/11/09","B/111/23","B/112/23","B/114/23","B/117/23","B/118/23","B/12/10","B/121/23","B/122/23","B/125/26","B/126/26","B/127/26","B/129/26","B/13/10","B/132/26","B/133/26","B/134/27","B/14/10","B/15/10","B/16/10","B/17/10","B/18/10","B/21/10","B/24/10","B/28/11","B/33/11","B/34/11","B/38/12","B/39/12","B/40/12","B/42/12","B/44/12","B/45/12","B/46/13","B/47/13","B/49/13","B/50/13","B/51/13","B/52/13","B/56/14","B/58/14","B/59/14","B/60/14","B/63/14","B/65/14","B/70/15","B/80/16","B/81/16","B/82/16","B/83/16","B/85/16","B/87/16","B/91/17","B/96/22","B/97/22","B/98/12","B/99/22"],null,null,null,["MwendoWabure","Barabarani","Barabarani (Jabwa)","Ramisi Secondary School","Chibwaga","Chibwaga Chidze","Tiwi Mkoyo (Bomani)","Chirima","Mkoyo","Mkoyo","Kirudi","Pongwe (Mzanyi 1)","Barabarani","Mabriva Tiwi","Madrasatul Kauther","Bowa (Mshindo Mosque)","Mkokoni (Busara)","Waa - Kitivo Maendeleo Mvumoni Waa","Barabarani Markazi","Waa Ganzoni","Mwagonga Waa (C9499)","Mwandimu","Mwandimu","Mwandimu 2","Denyenye Maweni","Shirazi Primary School","Ng'ombeni Vidziweni","Ng'ombeni Similani","Kadangani Waa","Shirazi Kakira","Shirazi Madukani","Shirazi Mkwajuni","Shirazi Pwani","Shirazi Taveta","Bodo Centre","Bodo Kilimakea","Kigombero Chirwa","Masimbani","Masimbani (Mkomani)","Chiruku","Masimbani","Makambani","Mwakoyo II (Makambani)","Mwakoyo","Makambani Centre","Maji Rila Baraka 2","Maji Rila Kijikuuni","Rila B (Upendo Borehole)","Kwa Mbugua","Rila Village (Mwananyamola)","Kikunguma Borehole","Mwananyamala Madrasatul Uda","Mwananyamala Primary School","Nguluku","Ndumbani","Mabovo Mrima","Bumbuni B","T. M","Marenje A","Marenje","Marenje","Vitsangalaweni Mosque","Mendza Mwenye Primary School","Dodoma Mendza Mwenye","Mwangulu Mosque","Mwachema","Mwachema","Mwachema (Chibwaga) Kokoni","Mwachema Vikokoni"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[-4.46201212553,-4.46759089652,-4.41736738739,-4.46767071446,-4.42596207438,-4.4673999959,-4.45813926595,-4.41399999608,-4.47543023864,-4.42105576923,-4.48684325657,-4.40796741081,-4.40746915898,-4.38445999614,-4.39198394187,-4.35131378451,-4.42148556108,-4.39606999614,-4.3489687144,-4.35612121343,-4.36338789836,-4.36291738801,-4.41955070974,-4.401935643,-4.37312369919,-4.29048814357,-4.27833866629,-4.27677054002,-4.40725778156,-4.44135190449,-4.39911999604,-4.41573992275,-4.41640807059,-4.39879140617,-4.42950514374,-4.43521999603,-4.43521402125,-4.39005275627,-4.38186367382,-4.45509450024,-4.44693188497,-4.37539020748,-4.38739783084,-4.4459597774,-4.44465971259,-4.44739462185,-4.44393384688,-4.5350445954,-4.5942731152,-4.41413221266,-4.40894795716,-4.62580141074,-4.64681825897,-4.54896168399,-4.60342168267,-4.60692250886,-4.59207529143,-4.56447582448,-4.55839982406,-4.55852791293],[39.481859742,39.4862169572,39.3729978773,39.488623645,39.3721098618,39.4899699984,39.483362475,39.3613399985,39.4784162437,39.3600026993,39.4699956932,39.3557512537,39.3378420952,39.4108399985,39.421618352,39.3241992003,39.4037258408,39.3343799985,39.3287945042,39.2932344261,39.2874962361,39.3104239952,39.4016878261,39.3311519609,39.2305666765,39.2672644929,39.2665934207,39.2752079301,39.3992387022,39.3865480463,39.3988299985,39.3330508318,39.3912940283,39.3423446573,39.3956723306,39.3946999985,39.3947199515,39.2994124219,39.3040417312,39.3848516401,39.3898498854,39.2942062608,39.2872259897,39.3804393091,39.3752919546,39.3696598979,39.3614739452,39.3737245042,39.3890000155,39.3471466542,39.3483339725,39.3867542127,39.3834026797,39.366889466,39.3491928118,39.3495731691,39.3532982722,39.1779874011,39.1996038991,39.1943662154],{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/5984/5984318.png","index":0},"iconWidth":30,"iconHeight":30},null,"Pump ID: C",{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["C/02/09","C/03/09","C/03/12","C/04/09","C/04/12","C/05/09","C/06/09","C/06/12","C/07/09","C/07/12","C/08/09","C/08/12","C/10/12","C/109/21","C/111/21","C/119/22","C/12/10","C/12/12","C/120/22","C/122/22","C/123/22","C/125/22","C/13/10","C/13/12","C/130/23","C/136/23","C/137/26","C/138/26","C/14/10","C/145/27","C/15/10","C/16/12","C/17/10","C/17/13","C/18/10","C/19/10","C/19/13","C/20/13","C/21/13","C/22/11","C/23/11","C/23/13","C/24/13","C/25/11","C/26/11","C/27/11","C/28/11","C/29/14","C/31/14","C/32/11","C/33/11","C/36/14","C/40/14","C/43/14","C/45/15","C/48/15","C/51/15","C/56/16","C/60/16","C/61/16"],null,null,null,["Vingujini","Vingujini","Magodi Primary School","Vingujini","Magodi (Manyatta)","Vingujini","Msambweni Police station","Gazore","Kisimachande","Nndenje (Nnrenje)","Mwagundu","Kilulu-Makutano","Maphombe-Safina","Amka village","Kibwaga","Lukore (Mzee Konde)","Mivumoni Secondaary School","Maphombe Primary","Lukore kwa Ex-Chief","Mawia A","Mawia kwa Steven","Mangawani B","Mivumoni Primary School","Maphombe Mosque -  Shukrani","Mnyalatsoni Primary School","Mkongani Kwa Chief","Mkongani","Mkongani (Mafumoni)","Mivumoni-Michungwani B","Manyatta","Mivumoni","Maphombe","Mivmoni kwa councillor","Maphombe (Rovu)","Mivumoni-Chidziweni","Mivumoni-Makutano","Mangawani Primary","Mangawani (Matuga)","Mangawani Scheme","Mutituni","Manyatta (Kwa Chief)","Mangawani (Mwaleni)","Mwaleni Kitulu","Mnazi 1 (Kwa Ngangi)","Mafisini Dispensary","Mnazi 1 A","Kiranga (Muongo Wa Nyayo)","Kanana Kwa Mwite","Mkuyuni Bati","Eshu Primary School","Eshu-Mwamudzi","Anzuwani Mosque","Majengo","Kidimu Primary","Fikirini Centre","Tswaka Dispensary","Tswaka Lola Gako","Perani Kidomaya Primary School","Matoroni Church","Matoroni (Mkuyuni)"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[-4.4231158632,-4.46649543227,-4.45963486041,-4.46119371375,-4.46428948338,-4.46097211922,-4.4703887145,-4.32820999614,-4.31735992857,-4.31101136423,-4.30308102696,-4.30717903843,-4.3158496561,-4.31662852671,-4.46625064878,-4.32515145977,-4.29788602455,-4.29790138815,-4.29227346186,-4.2922501039,-4.29604284416,-4.30281550719,-4.30376809034,-4.29944460927,-4.29636506771,-4.29980393258,-4.31050999615,-4.47285567348,-4.30921555887,-4.29542155055,-4.23617562016,-4.29009951629,-4.28686163979,-4.28026134151,-4.27373857995,-4.26148467607,-4.27684859081,-4.27446463952,-4.28802472832,-4.47243999598,-4.27433173292,-4.25050906151,-4.24278560198,-4.24154902881,-4.47734390978,-4.24078336796,-4.24078336796,-4.23990424259,-4.48208232317,-4.17299595128,-4.4811999959,-4.17109445593,-4.1748742088,-4.45577711171,-4.46234374199,-4.4768467384,-4.46088293399,-4.46112091747,-4.41103502312,-4.40294999602,-4.39192999604,-4.37908412467,-4.36587483402,-4.36284262564,-4.36704182117,-4.36262868636,-4.35691965252,-4.3585688429,-4.36261505272,-4.35629797146,-4.36281999609,-4.3713413679,-4.3722199961,-4.34642358794,-4.34433996056,-4.33857041888,-4.32579999611,-4.31894164091,-4.31832516253,-4.35227907762,-4.35831714031,-4.34761999611,-4.3421479613,-4.34659439856,-4.34561589004,-4.34017162482,-4.32374487797,-4.31694044686,-4.34084240213,-4.33377491609],[39.4765888938,39.4736873172,39.4788837296,39.474468099,39.4715406679,39.4673472483,39.4685339954,39.5362899985,39.535071728,39.5322195989,39.5402974738,39.5403003622,39.5470923037,39.5458672671,39.4603109414,39.5441340766,39.543637085,39.5474489608,39.5489498601,39.5436691434,39.540427692,39.5319615822,39.528069235,39.5270569661,39.5324707675,39.5175590316,39.5159899985,39.4585393579,39.5126179737,39.5614419882,39.5632101586,39.5528502452,39.551847658,39.5468957331,39.547341671,39.5544517415,39.5500562623,39.5440440768,39.5572102579,39.4535799984,39.5651842849,39.5700778445,39.5671887159,39.5633942618,39.4566312294,39.5712421159,39.5712421159,39.5734401019,39.4450964539,39.5875729496,39.4473599984,39.589923139,39.5920703397,39.4710214735,39.3791677806,39.3584884069,39.3514680097,39.3456272492,39.4962473996,39.4841799985,39.4842799985,39.4807337207,39.4687568348,39.525857124,39.5234717721,39.5213057646,39.5223923129,39.5184280585,39.5148439317,39.4918313574,39.4903999985,39.4791606173,39.4873599985,39.4989986213,39.5034312115,39.5003002115,39.4827299985,39.4972683726,39.4992776048,39.5349430641,39.5291164109,39.5362699985,39.5337643598,39.5271435922,39.5162382734,39.5137832989,39.5114922218,39.5137406087,39.5378188529,39.5409860576],{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/5984/5984318.png","index":0},"iconWidth":30,"iconHeight":30},null,"Pump ID: D",{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["D/01/09","D/04/09","D/05/09","D/06/09","D/07/09","D/09/09","D/10/09","D/100/16","D/102/16","D/103/16","D/104/16","D/105/16","D/107/16","D/108/16","D/11/09","D/110/16","D/113/17","D/114/16","D/115/16","D/117/17","D/118/17","D/119/17","D/121/17","D/122/17","D/123/17","D/127/17","D/129/19","D/13/10","D/130/19","D/137/15","D/141/19","D/144/20","D/145/20","D/147/20","D/148/20","D/149/20","D/150/20","D/151/20","D/158/21","D/16/10","D/160/21","D/162/22","D/166/22","D/167/22","D/17/10","D/171/22","D/173/22","D/174/22","D/18/10","D/198/26","D/20/10","D/200/26","D/201/26","D/203/27","D/25/10","D/30/11","D/31/11","D/32/11","D/36/12","D/37/12","D/38/12","D/40/12","D/47/12","D/48/13","D/49/13","D/50/13","D/51/13","D/52/13","D/54/13","D/62/13","D/63/13","D/67/13","D/68/13","D/71/14","D/73/14","D/75/14","D/79/14","D/82/14","D/83/14","D/84/15","D/85/15","D/86/15","D/88/15","D/90/15","D/91/15","D/94/15","D/96/15","D/97/15","D/98/16","D/99/16"],null,null,null,["Sala center","Bomani Mwebe Ngoma","Bomani KAG Church","Bomani Viembeni","Bomani-Kwa Soroh","Marigiza Madrasa","Nganja Madzunini","Ukunda Scheme Kwa Boga","Ukunda Scheme Kwa Majeni","Ukunda Scheme Kwa Madzugwe","Ukunda Scheme Jambo","Ukunda Scheme Kwa Msaji","Mvindeni Primary School","Mvindeni Chibavani","Milalani-Chivingoni (Jitegemee)","Ukunda Scheme Dario Corazza Nursery School","Shamu Primary School","Shamu - Mwakoyanje","Shamu - Kidzangoni","Shamu kwa Bundiko","Shamu - Magombani","Mbuwani Muswa","Mbuwani Kaherwa","Mbuwani Kwa Dubi","Mbuwani Primary School","Mbuwani Spaki","Mabokoni Msikitini","Milalani Primary School","Mabokoni - Bamako","Magutu - Gandzoni","Kibundani Msikitini","Bongwe - Mwamaku","Bongwe - Mayabo","Mwamanga Primary School","Mwamanga - Mwatowa","Mwamtenda Msikitini","Mwamanga - Mwaroro","Mwamanga Catholic Nursery School","Ukuunda - Chilolapwa","Milalani-Nimbodze kwa Mwabiti","Diani - Mwachidafu","Tiwi - Mbokweni","Tiwi - Konu Msikitini","Tiwi - Kanu Magadini","Milalani Rangwi","Tiwi - Simkumbe","Tiwi - Manunduni","Tiwi - Mshikeni","Mabatani kwa Rutah (Msikiti mpya)","Waa - Mnyendzeni","Mabatani kwa Miki","Waa - Magundo","Waa - Magundo Kwa Mwamundo","Marigiza - Baa Kanda (Voroni)","Mwachande Sokoni","Wasaa Chindunguni","Kivuleni Matsotoko","Kivuleni Mosque (Centre)","Sala center","Fihoni Primary School","Madzi Kuko Centre","Magaoni Hehe","Mwandimu-Mlungunipa","Chibarani - Mwaligulu","Chibarani - Gandini","Chibarani - Mvumoni","Chibarani - Ngumanayende","Muhaka - Zengwa B","Kilole - Gandini","Zigira Chiyaye A","Zigira Chiyaye B","Zigira Bodo B","Zigira Bodo C","Kilole - Mwaweche A","Kilole - Dungumale","Magomani Mbavu","Mkambani Primary School","Mwanjamba Kwa Mwakassim A","Mwanjamba Kwa Mwakassim B","Kinondo - Mwembeni","Kinondo - Kibomani Ganja la Simba","Mwabungo - Chiuzini","Mwabungo-Mwamua B","Mwabungo - Mwareni","Muhaka - Mtsangatifu I","Muhaka Primary School","Muhaka - Chigaleni","Maboko Msafini","Mwabungo Kolorado","Mwabungo Stamili"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addMarkers","args":[[-4.2231681715,-4.27668561263,-4.22242248141,-4.1944091696,-4.48220968932,-4.38458999605],[39.5859615128,39.5748820759,39.5910879603,39.5987886097,39.4585722197,39.5231499985],{"iconUrl":{"data":"https://cdn-icons-png.flaticon.com/512/5984/5984318.png","index":0},"iconWidth":30,"iconHeight":30},null,"Pump ID: E",{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},["E/01/26","E/01/27","E/02/26","E/03/26","E/17/01","E/29/01"],null,null,null,["Tiwi Kizinga","Mwamambi Primary School","Tiwi Kizinga","Kombani Kitsaka Madza","Milalani","Kinindo Amani Mosque"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addLayersControl","args":[[],["Pump ID: A","Pump ID: B","Pump ID: C","Pump ID: D","Pump ID: E"],{"collapsed":false,"autoZIndex":true,"position":"topright"}]}],"limits":{"lat":[-4.659391543,-4.12689268932],"lng":[39.1279720814,39.6315005436]}},"evals":[],"jsHooks":[]}</script><p>We can observe that group A pumps are mostly located along the
coastal line. Group B has two clusters: one is along the coastal line in
upper north above Ukunda and the other is in southwest. The majority of
group C is clustered in the middle region near Msambweni. Group D pumps
are located along the highway A7 in the north. Finally, Group E only has
a few pumps and spreads out along A7 too.</p>
<p><em>How do we display the pumps in different groups? Follow these
steps:</em></p>
<ol style="list-style-type: decimal">
<li>
<strong>Identify Pump Groups</strong>:
<ul>
<li>Start by examining the <code>pumpid</code> variable; it indicates
which group each pump belongs to.</li>
</ul>
</li>
<li>
<strong>Add Markers for Each Group</strong>:
<ul>
<li>For each group of pumps, we need to add markers on the map.</li>
<li>To do this, we use the <code>addMarkers</code> function from the
<code>leaflet</code> package.</li>
</ul>
</li>
<li>
<strong>Filter Data for Each Group</strong>:
<ul>
<li>Within each <code>addMarkers</code> call, we must specify which part
of the data corresponds to one group.</li>
<li>To achieve this, we followed these steps:
<ul>
<li>Observe taht the <code>pumpid</code> variable starts with a letter
indicating the group, e.g., “A” in “A/01/09”.</li>
<li>Extract pumps from a specific group using the
<code>startsWith</code> function:
<code>startsWith(pumpid, "A")</code>.</li>
<li>Apply this pattern to filter the <code>location</code> data using
<code>location |&gt; dplyr::filter(startsWith(pumpid, "A"))</code>. You
can run this alone to see that it results in a smaller dataframe.</li>
<li>Use the filtered data as input for the <code>data</code> parameter
in <code>addMarkers</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<strong>Control the Displayed Layers</strong>:
<ul>
<li>After adding all the layers for different groups, you may want to
control which groups are visible on the map.</li>
<li>For instance, you might want to display only groups A and E.</li>
<li>To achieve this flexibility, add the final step by using
<code>addLayersControl</code> and specify the groups you want to control
in the <code>overlayGroups</code> parameter.</li>
<li>Ensure that you use the same labels that you assigned to each group
in step 3.</li>
</ul>
</li>
</ol>
</div>
<div class="section level2">
<h2 id="weekly-volume-change">Weekly Volume Change<a class="anchor" aria-label="anchor" href="#weekly-volume-change"></a>
</h2>
<p>Now, we roughly know the location distribution of the pumps. Let’s
digest the data a bit more! This dataset is amazingly recording every
week of a year so we can explore seasonal patterns of the hand
pumps.</p>
<div class="section level3">
<h3 id="how-does-weekly-volume-change-in-2014-and-2015">How does weekly volume change in 2014 and 2015?<a class="anchor" aria-label="anchor" href="#how-does-weekly-volume-change-in-2014-and-2015"></a>
</h3>
<p>To answer this question, we are going to plot a heatmap to show the
weekly volumes. A heatmap is a intuitive plot to observe, for
example,</p>
<ol style="list-style-type: decimal">
<li>Which weeks have larger volumes of water?</li>
<li>Are two pumps performing similar?</li>
<li>Which pumps or weeks are missing in monitoring?</li>
</ol>
<p>First, we plot the heatmap for year 2014:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pivot the data for easier plotting</span></span>
<span><span class="va">weeklyvol2014_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">weeklyvol2014</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">53</span>, names_to <span class="op">=</span> <span class="st">"week"</span><span class="op">)</span> </span>
<span>                      <span class="co"># dplyr::filter(stringr::str_starts(pumpid, "C"))</span></span>
<span></span>
<span><span class="co"># Set an order for plotting from largest volume to smallest</span></span>
<span><span class="va">facility_order</span> <span class="op">&lt;-</span> <span class="va">weeklyvol2014_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pumpid</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>tot_vol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">tot_vol</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weeklyvol2014_long</span> <span class="op">&lt;-</span> <span class="va">weeklyvol2014_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pumpid <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html" class="external-link">fct_relevel</a></span><span class="op">(</span></span>
<span>    <span class="va">pumpid</span>, <span class="va">facility_order</span><span class="op">$</span><span class="va">pumpid</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualization</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">weeklyvol2014_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">pumpid</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"steelblue"</span>, na.value <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Aesthetic </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Week"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Pump ID"</span>, </span>
<span>    title <span class="op">=</span> <span class="st">"Weekly volume in 2014"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Sorted by total volume largest to smallest"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/volume2014-1.png" width="700"></p>
<p>Similarly, we plot the heatmap for year 2015:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weeklyvol2015_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="va">weeklyvol2015</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">53</span>, names_to <span class="op">=</span> <span class="st">"week"</span><span class="op">)</span> </span>
<span>                      <span class="co"># dplyr::filter(stringr::str_starts(pumpid, "C"))</span></span>
<span><span class="va">facility_order</span> <span class="op">&lt;-</span> <span class="va">weeklyvol2015_long</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">pumpid</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>tot_vol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">value</span>, na.rm<span class="op">=</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">tot_vol</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weeklyvol2015_long</span> <span class="op">&lt;-</span> <span class="va">weeklyvol2015_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>pumpid <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html" class="external-link">fct_relevel</a></span><span class="op">(</span></span>
<span>    <span class="va">pumpid</span>, <span class="va">facility_order</span><span class="op">$</span><span class="va">pumpid</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">weeklyvol2015_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">pumpid</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"steelblue"</span>, na.value <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Aesthetic </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    axis.ticks.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Week"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Pump ID"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Weekly volume in 2015"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Sorted by total volume largest to smallest"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/volume%202015-1.png" width="700"></p>
<p>From the figures, we can roughly see some weeks usually have larger
volumes (e.g., around week 10) and many of the pumps are under-monitored
(i.e., they do not have a value recorded). There are also pumps that do
not have records for some weeks in a year which are typically weeks in
the second half of the year. To compare two pumps, these figures might
be hard to read since we have around 300 pumps and all are plotted on
the same figure. Therefore, we can zoom-in a little, we can only plot
several pumps or only plot a group of pumps by providing the filtered
data.</p>
<p>Let’s take group E in year 2015:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_e_2015</span> <span class="op">&lt;-</span> <span class="va">weeklyvol2015_long</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/startsWith.html" class="external-link">startsWith</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">pumpid</span><span class="op">)</span>, <span class="st">"E"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">group_e_2015</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">week</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">pumpid</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html" class="external-link">scale_fill_gradient</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"steelblue"</span>, na.value <span class="op">=</span> <span class="st">"grey80"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Aesthetic </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Week"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">" Pump ID"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Weekly volume in 2015"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Group E, sorted by total volume largest to smallest</span></span>
<span><span class="st">  "</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="examples_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Further questions:</p>
<ul>
<li>Where are the pumps that have many NA values?</li>
<li>Do these pumps have an improvement in year 2015 from year 2014?</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Crafted by Mian Zhong.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
